import numpy as np
import os
import matplotlib.pyplot as plt

x=np.array([[[0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4], [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4], [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4], [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4], [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4]], [[0.32, 0.32, 0.32, 0.32, 0.32, 0.32, 0.32, 0.32, 0.32], [0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34], [0.36, 0.36, 0.36, 0.36, 0.36, 0.36, 0.36, 0.36, 0.36], [0.38, 0.38, 0.38, 0.38, 0.38, 0.38, 0.38, 0.38, 0.38], [0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4]]]) 
xname='HFSCREEN+AEXX'
xx=x[0]
yy=x[1]

#old:different relaxation geometries#z1=np.array([[0.1521, 0.2848, 0.4118, 0.5361, 0.652, 0.7525, 0.8371, 0.9081, 0.9675], [0.0796, 0.2207, 0.3553, 0.4873, 0.6105, 0.7175, 0.8078, 0.8828, 0.9467], [0.0069, 0.1559, 0.2986, 0.4381, 0.5689, 0.6822, 0.7776, 0.8578, 0.9256], [-0.0665, 0.091, 0.2413, 0.3888, 0.5266, 0.6464, 0.7475, 0.8323, 0.9042], [-0.14, 0.0257, 0.1841, 0.3393, 0.4844, 0.6104, 0.7173, 0.8066, 0.8827]]) 
#defecttype='$\mathit{V}_\mathrm{O}$'
#z1=y=np.array([[0.0984, 0.2301, 0.3569, 0.4814, 0.5973, 0.6981, 0.7824, 0.8531, 0.9124], [0.0273, 0.1671, 0.302, 0.4341, 0.5574, 0.6643, 0.7543, 0.8294, 0.8926], [-0.0442, 0.104, 0.2467, 0.3865, 0.517, 0.6302, 0.7256, 0.8054, 0.8727], [-0.1158, 0.0406, 0.1913, 0.3387, 0.4764, 0.596, 0.6967, 0.7813, 0.8525], [-0.1876, -0.023, 0.1355, 0.291, 0.4358, 0.5615, 0.6676, 0.7568, 0.8321]]) 
#defecttype='$\mathrm{H}_\mathit{i}$'
#z1=np.array([[0.116, 0.2451, 0.3749, 0.5037, 0.6243, 0.7292, 0.8177, 0.8925, 0.9562], [0.029, 0.166, 0.304, 0.4406, 0.5688, 0.68, 0.7746, 0.8542, 0.9222], [-0.0592, 0.086, 0.2333, 0.3768, 0.513, 0.6311, 0.7314, 0.8161, 0.8885], [-0.148, 0.0053, 0.1595, 0.3124, 0.4561, 0.5814, 0.6876, 0.7776, 0.8547], [-0.2371, -0.0757, 0.0866, 0.2476, 0.399, 0.5311, 0.6433, 0.7387, 0.8205]]) 
#defecttype='elongate-Be-1' #'perturb a Be atom'
#z1=np.array([[-0.2916, -0.1617, -0.0316, 0.0967, 0.2073, 0.2868, 0.3382, 0.3709, 0.3919], [-0.3384, -0.2003, -0.0618, 0.0742, 0.1919, 0.2761, 0.3309, 0.3655, 0.388], [-0.3853, -0.239, -0.0924, 0.0517, 0.1762, 0.2656, 0.3235, 0.3602, 0.384], [-0.4321, -0.2782, -0.1233, 0.0291, 0.1605, 0.255, 0.3159, 0.3547, 0.3799], [-0.4788, -0.3171, -0.1543, 0.0063, 0.1451, 0.2444, 0.3087, 0.3496, 0.3762]]) 
#defecttype='perturb an O atom'
#z1=np.array([[-0.3007, -0.171, -0.0411, 0.0871, 0.1981, 0.2781, 0.33, 0.3633, 0.3849], [-0.3479, -0.21, -0.0719, 0.064, 0.1821, 0.2669, 0.3223, 0.3576, 0.3806], [-0.3953, -0.2493, -0.1032, 0.0409, 0.166, 0.2558, 0.3145, 0.3519, 0.3763], [-0.4426, -0.289, -0.1345, 0.0177, 0.1497, 0.2445, 0.3065, 0.3461, 0.3718], [-0.4902, -0.3285, -0.1662, -0.0057, 0.1337, 0.2335, 0.2989, 0.3405, 0.3678]]) 
defecttype='elongate-Be-2'
z1=y=np.array([[-0.0991, 0.0304, 0.1591, 0.2888, 0.4031, 0.4892, 0.5407, 0.5906, 0.6075], [-0.1602, -0.0228, 0.1163, 0.251, 0.3752, 0.4659, 0.5363, 0.5642, 0.5996], [-0.2278, -0.0833, 0.0641, 0.2096, 0.3387, 0.4413, 0.5133, 0.5557, 0.5898], [-0.303, -0.1515, 0.0033, 0.1572, 0.2973, 0.4078, 0.4901, 0.5537, 0.5581], [-0.3871, -0.2278, -0.0655, 0.0961, 0.2452, 0.3683, 0.4607, 0.5256, 0.5907]]) 

z1name='koopmans'
z2=np.array([[11.4827, 11.2362, 10.9875, 10.7584, 10.5468, 10.3508, 10.169, 10.0002, 9.8428], [11.7176, 11.4559, 11.1916, 10.9481, 10.7229, 10.5144, 10.321, 10.1412, 9.974], [11.9531, 11.6812, 11.403, 11.1297, 10.8996, 10.6786, 10.4729, 10.2822, 10.1052], [12.196, 11.8967, 11.6103, 11.3357, 11.0713, 10.8428, 10.6324, 10.4245, 10.2368], [12.4258, 12.118, 11.8069, 11.5198, 11.2545, 11.0076, 10.7876, 10.5632, 10.3739]]) 
z2name='bandgap'
#print('%s=%s\n%s=%s\n'%(xname,x,yname,y))
x_str='HFSCREEN'
y_str='AEXX'
z_str='bandgap_koopmans'
header=''
#
plt.figure()
SMALL_SIZE = 12
MEDIUM_SIZE = 14
BIGGER_SIZE = 16
plt.rc('font', size=BIGGER_SIZE)          # controls default text sizes
plt.rc('axes', titlesize=BIGGER_SIZE)     # fontsize of the axes title
plt.rc('axes', labelsize=MEDIUM_SIZE)    # fontsize of the x and y labels
plt.rc('xtick', labelsize=SMALL_SIZE)    # fontsize of the tick labels
plt.rc('ytick', labelsize=SMALL_SIZE)    # fontsize of the tick labels
plt.rc('legend', fontsize=SMALL_SIZE)    # legend fontsize
plt.rc('figure', titlesize=BIGGER_SIZE)  # fontsize of the figure title

fig, ax = plt.subplots()
levels=[-0.2,-0.1,0.,0.1,0.2]
CS = ax.contourf(xx, yy, z1, levels=levels)
plt.colorbar(CS)
levels=np.linspace(10.1,12.1,6)
CS = ax.contour(xx, yy, z2, levels=levels)
ax.clabel(CS, inline=True, fontsize=16)

plt.xlabel(x_str)
plt.ylabel(y_str)
plt.title(defecttype+' Bandgap + Koopmans')
plt.tight_layout()
figname="%scontour_%s_%s_%s.pdf" % (header,z_str, x_str, y_str)
print('save figure:%s/%s'% (os.environ['PWD'],figname))
plt.savefig(figname,dpi=600)
plt.close()
